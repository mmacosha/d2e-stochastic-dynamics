sampler:
  name: d2e
  device: cuda:0

  # logging
  save_checkpoint_freq: 5
  log_fwd_freq: 1
  log_bwd_freq: 1
  watch_models: false
  
  # training
  batch_size: 256
  matching_method: ll
  backward_first: true
  num_sb_steps: 100
  fwd_optim_lr: 5e-4
  bwd_optim_lr: 5e-4
  num_fwd_steps: 2000
  num_bwd_steps: 500
  fwd_ema_decay: 0.0
  bwd_ema_decay: 0.0

  # ref process
  dt: 0.04
  alpha: 0.0
  t_max: 0.8
  n_steps: 20

  # policy
  n_trajectories: 2
  start_mixed_from: 0
  off_policy_fraction: 0.2
  
  # bufferx
  buffer_type: langevin
  buffer_size: 1024
  init_step_size: 0.01
  num_langevin_steps: 10
  buffer_sampler: ula2
  noise_start_ratio: 0.0
  reward_proportional_sample: false
  anneal_value: 0.1
  hmc_freq: 4

exp:
  id: null
  resume: allow
  name: outsourced-sb
  project: sb
  mode: online

data:
  p_0: 
    name: simple_gaussian
    args: 
      mean: 0.0
      std: 1.0
      dim: 256
      device: ${sampler.device}
  p_1:
    name: cls_reward_dist
    args: 
      generator_type: cifar10-gan-z256
      classifier_type: cifar10-cls
      prior_dim: 256
      target_classes: [5]
      reward_type: sum
      device: ${sampler.device}

models:
  fwd:
    t_emb_size: 128
    x_emb_size: 256
    in_dim: 256
    out_dim: 256
    n_main_body_layers: 6
    predict_log_var: true
    use_residual: false
  bwd:
    t_emb_size: 128
    x_emb_size: 256
    in_dim: 256
    out_dim: 256
    n_main_body_layers: 6
    predict_log_var: true
    use_residual: false

hydra:
  run:
    dir: "."
  output_subdir: null
  job_logging:
    disable_existing_loggers: true
  verbose: false